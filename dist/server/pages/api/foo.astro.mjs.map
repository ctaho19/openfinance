{"version":3,"file":"foo.astro.mjs","sources":["../../../../src/pages/api/foo/index.ts"],"sourcesContent":["import type { APIRoute } from \"astro\";\nimport { getSession } from \"../../../lib/get-session-astro\";\nimport { getFOOProgress, updateFOOStep } from \"../../../lib/services/foo\";\nimport type { FOOStep } from \"@prisma/client\";\nimport { apiResponse, apiError } from \"../../../lib/api-utils\";\n\nexport const GET: APIRoute = async ({ request }) => {\n  const session = await getSession(request);\n  if (!session?.user?.id) {\n    return apiError(\"Unauthorized\", 401);\n  }\n\n  const progress = await getFOOProgress(session.user.id);\n  return apiResponse(progress);\n};\n\nexport const PATCH: APIRoute = async ({ request }) => {\n  const session = await getSession(request);\n  if (!session?.user?.id) {\n    return apiError(\"Unauthorized\", 401);\n  }\n\n  try {\n    const body = await request.json();\n    const { step, ...data } = body;\n\n    if (!step) {\n      return apiError(\"Step is required\", 400);\n    }\n\n    const updated = await updateFOOStep(session.user.id, step as FOOStep, data);\n    return apiResponse(updated);\n  } catch (error) {\n    return apiError(error instanceof Error ? error.message : \"Failed to update FOO progress\", 400);\n  }\n};\n"],"names":[],"mappings":";;;;;AAMO,MAAM,GAAA,GAAgB,OAAO,EAAE,OAAA,EAAQ,KAAM;AAClD,EAAA,MAAM,OAAA,GAAU,MAAM,UAAA,CAAW,OAAO,CAAA;AACxC,EAAA,IAAI,CAAC,OAAA,EAAS,IAAA,EAAM,EAAA,EAAI;AACtB,IAAA,OAAO,QAAA,CAAS,gBAAgB,GAAG,CAAA;AAAA,EACrC;AAEA,EAAA,MAAM,QAAA,GAAW,MAAM,cAAA,CAAe,OAAA,CAAQ,KAAK,EAAE,CAAA;AACrD,EAAA,OAAO,YAAY,QAAQ,CAAA;AAC7B,CAAA;AAEO,MAAM,KAAA,GAAkB,OAAO,EAAE,OAAA,EAAQ,KAAM;AACpD,EAAA,MAAM,OAAA,GAAU,MAAM,UAAA,CAAW,OAAO,CAAA;AACxC,EAAA,IAAI,CAAC,OAAA,EAAS,IAAA,EAAM,EAAA,EAAI;AACtB,IAAA,OAAO,QAAA,CAAS,gBAAgB,GAAG,CAAA;AAAA,EACrC;AAEA,EAAA,IAAI;AACF,IAAA,MAAM,IAAA,GAAO,MAAM,OAAA,CAAQ,IAAA,EAAK;AAChC,IAAA,MAAM,EAAE,IAAA,EAAM,GAAG,IAAA,EAAK,GAAI,IAAA;AAE1B,IAAA,IAAI,CAAC,IAAA,EAAM;AACT,MAAA,OAAO,QAAA,CAAS,oBAAoB,GAAG,CAAA;AAAA,IACzC;AAEA,IAAA,MAAM,UAAU,MAAM,aAAA,CAAc,QAAQ,IAAA,CAAK,EAAA,EAAI,MAAiB,IAAI,CAAA;AAC1E,IAAA,OAAO,YAAY,OAAO,CAAA;AAAA,EAC5B,SAAS,KAAA,EAAO;AACd,IAAA,OAAO,SAAS,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,iCAAiC,GAAG,CAAA;AAAA,EAC/F;AACF,CAAA;;;;;;;;;;;;"}