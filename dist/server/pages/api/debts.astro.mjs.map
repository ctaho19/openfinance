{"version":3,"file":"debts.astro.mjs","sources":["../../../../src/pages/api/debts/index.ts"],"sourcesContent":["import type { APIRoute } from \"astro\";\nimport { getSession } from \"../../../lib/get-session-astro\";\nimport { listDebts, createDebt } from \"../../../lib/services/debts\";\nimport { apiResponse, apiError } from \"../../../lib/api-utils\";\n\nexport const GET: APIRoute = async ({ request }) => {\n  const session = await getSession(request);\n  if (!session?.user?.id) {\n    return apiError(\"Unauthorized\", 401);\n  }\n\n  const url = new URL(request.url);\n  const sortBy = url.searchParams.get(\"sortBy\") || \"effective\";\n\n  const debts = await listDebts(session.user.id, sortBy);\n  return apiResponse(debts);\n};\n\nexport const POST: APIRoute = async ({ request }) => {\n  const session = await getSession(request);\n  if (!session?.user?.id) {\n    return apiError(\"Unauthorized\", 401);\n  }\n\n  try {\n    const body = await request.json();\n    const debt = await createDebt(session.user.id, body);\n    return apiResponse(debt, 201);\n  } catch (error) {\n    return apiError(error instanceof Error ? error.message : \"Failed to create debt\", 400);\n  }\n};\n"],"names":[],"mappings":";;;;;AAKO,MAAM,GAAA,GAAgB,OAAO,EAAE,OAAA,EAAQ,KAAM;AAClD,EAAA,MAAM,OAAA,GAAU,MAAM,UAAA,CAAW,OAAO,CAAA;AACxC,EAAA,IAAI,CAAC,OAAA,EAAS,IAAA,EAAM,EAAA,EAAI;AACtB,IAAA,OAAO,QAAA,CAAS,gBAAgB,GAAG,CAAA;AAAA,EACrC;AAEA,EAAA,MAAM,GAAA,GAAM,IAAI,GAAA,CAAI,OAAA,CAAQ,GAAG,CAAA;AAC/B,EAAA,MAAM,MAAA,GAAS,GAAA,CAAI,YAAA,CAAa,GAAA,CAAI,QAAQ,CAAA,IAAK,WAAA;AAEjD,EAAA,MAAM,QAAQ,MAAM,SAAA,CAAU,OAAA,CAAQ,IAAA,CAAK,IAAI,MAAM,CAAA;AACrD,EAAA,OAAO,YAAY,KAAK,CAAA;AAC1B,CAAA;AAEO,MAAM,IAAA,GAAiB,OAAO,EAAE,OAAA,EAAQ,KAAM;AACnD,EAAA,MAAM,OAAA,GAAU,MAAM,UAAA,CAAW,OAAO,CAAA;AACxC,EAAA,IAAI,CAAC,OAAA,EAAS,IAAA,EAAM,EAAA,EAAI;AACtB,IAAA,OAAO,QAAA,CAAS,gBAAgB,GAAG,CAAA;AAAA,EACrC;AAEA,EAAA,IAAI;AACF,IAAA,MAAM,IAAA,GAAO,MAAM,OAAA,CAAQ,IAAA,EAAK;AAChC,IAAA,MAAM,OAAO,MAAM,UAAA,CAAW,OAAA,CAAQ,IAAA,CAAK,IAAI,IAAI,CAAA;AACnD,IAAA,OAAO,WAAA,CAAY,MAAM,GAAG,CAAA;AAAA,EAC9B,SAAS,KAAA,EAAO;AACd,IAAA,OAAO,SAAS,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,yBAAyB,GAAG,CAAA;AAAA,EACvF;AACF,CAAA;;;;;;;;;;;;"}