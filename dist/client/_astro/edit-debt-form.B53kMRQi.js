import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.Cd_vQiNd.js";import{C as S,a as C,b as F,c as E}from"./card.CxXQM9B9.js";import{L as k,B as o}from"./button.B0dCfUPv.js";import{B as R}from"./bank-badge.D8M1MxtW.js";import{A as T}from"./arrow-left.CGCSNnMn.js";import"./createLucideIcon.DV6VgPWa.js";import"./building-2.CScN-oDP.js";const L=[{value:"CREDIT_CARD",label:"Credit Card"},{value:"AUTO_LOAN",label:"Auto Loan"},{value:"STUDENT_LOAN",label:"Student Loan"},{value:"PERSONAL_LOAN",label:"Personal Loan"},{value:"BNPL",label:"Buy Now Pay Later"},{value:"MORTGAGE",label:"Mortgage"},{value:"OTHER",label:"Other"}],w=[{value:"ACTIVE",label:"Active"},{value:"PAID_OFF",label:"Paid Off"},{value:"DEFERRED",label:"Deferred"}];function H({debtId:c}){const[g,m]=r.useState(!0),[u,h]=r.useState(!1),[x,i]=r.useState(""),[t,y]=r.useState(null),[p,N]=r.useState([]),[b,j]=r.useState("");r.useEffect(()=>{Promise.all([fetch(`/api/debts/${c}`).then(a=>a.json()),fetch("/api/bank-accounts").then(a=>a.json())]).then(([a,s])=>{a.error?i(a.error):(y(a),j(a.bankAccountId||"")),Array.isArray(s)&&N(s),m(!1)}).catch(()=>{i("Failed to load debt"),m(!1)})},[c]);async function v(a){a.preventDefault(),h(!0),i("");const s=new FormData(a.currentTarget),A={name:s.get("name"),type:s.get("type"),currentBalance:parseFloat(s.get("currentBalance")),originalBalance:parseFloat(s.get("originalBalance")),interestRate:parseFloat(s.get("interestRate")),minimumPayment:parseFloat(s.get("minimumPayment")),dueDay:parseInt(s.get("dueDay"),10),status:s.get("status"),notes:s.get("notes")||null,bankAccountId:b||null},f=await fetch(`/api/debts/${c}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(f.ok){const d=new URL(window.location.href),P=d.searchParams.get("sort")||"name",D=d.searchParams.get("dir")||"asc";window.location.href=`/dashboard/debts?sort=${P}&dir=${D}`}else{const d=await f.json();i(d.error||"Failed to update debt"),h(!1)}}const l="w-full px-4 py-2 bg-theme-secondary border border-theme rounded-xl text-theme-primary placeholder-theme-muted focus:outline-none focus:ring-2 focus:ring-accent-500/20 focus:border-accent-500",n="block text-sm font-medium text-theme-secondary mb-2";if(g)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(k,{className:"h-8 w-8 animate-spin text-accent-500"})});if(!t)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-theme-secondary",children:"Debt not found"}),e.jsx("a",{href:"/dashboard/debts",className:"text-accent-500 hover:underline mt-2 inline-block",children:"Back to debts"})]});const B=t.type==="BNPL";return e.jsxs("div",{className:"animate-fade-in max-w-2xl mx-auto space-y-6 lg:space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("a",{href:"/dashboard/debts",children:e.jsx(o,{variant:"ghost",size:"sm",leftIcon:e.jsx(T,{className:"h-4 w-4"}),children:"Back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-theme-primary",children:"Edit Debt"}),e.jsx("p",{className:"text-theme-secondary mt-1",children:t.name})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(F,{children:"Debt Details"})}),e.jsx(E,{children:e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[x&&e.jsx("div",{className:"p-3 rounded-xl bg-danger-50 dark:bg-danger-600/10 border border-danger-200 dark:border-danger-600/30 text-danger-700 dark:text-danger-400 text-sm",children:x}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:n,children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,defaultValue:t.name,className:l})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:n,children:"Type"}),e.jsx("select",{id:"type",name:"type",required:!0,defaultValue:t.type,className:l,children:L.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:n,children:"Status"}),e.jsx("select",{id:"status",name:"status",required:!0,defaultValue:t.status,className:l,children:w.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentBalance",className:n,children:"Current Balance ($)"}),e.jsx("input",{type:"number",id:"currentBalance",name:"currentBalance",required:!0,min:"0",step:"0.01",inputMode:"decimal",defaultValue:t.currentBalance,className:l})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"originalBalance",className:n,children:"Original Balance ($)"}),e.jsx("input",{type:"number",id:"originalBalance",name:"originalBalance",required:!0,min:"0",step:"0.01",inputMode:"decimal",defaultValue:t.originalBalance,className:l})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"interestRate",className:n,children:"Interest Rate (% APR)"}),e.jsx("input",{type:"number",id:"interestRate",name:"interestRate",required:!0,min:"0",max:"100",step:"0.01",inputMode:"decimal",defaultValue:t.interestRate,className:l})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"minimumPayment",className:n,children:B?"Payment Amount ($)":"Minimum Payment ($)"}),e.jsx("input",{type:"number",id:"minimumPayment",name:"minimumPayment",required:!0,min:"0",step:"0.01",inputMode:"decimal",defaultValue:t.minimumPayment,className:l})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dueDay",className:n,children:"Due Day of Month (1-31)"}),e.jsx("input",{type:"number",id:"dueDay",name:"dueDay",required:!0,min:"1",max:"31",defaultValue:t.dueDay,className:l})]}),p.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Payment Bank Account"}),e.jsx(R,{value:b,onChange:j,banks:p})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:n,children:"Notes (optional)"}),e.jsx("textarea",{id:"notes",name:"notes",rows:3,defaultValue:t.notes||"",placeholder:"Any additional notes about this debt...",className:l})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(o,{type:"submit",disabled:u,children:u?"Saving...":"Save Changes"}),e.jsx("a",{href:"/dashboard/debts",children:e.jsx(o,{type:"button",variant:"secondary",children:"Cancel"})})]})]})})]})]})}export{H as default};
//# sourceMappingURL=edit-debt-form.B53kMRQi.js.map
