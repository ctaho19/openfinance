{"version":3,"file":"bank-accounts-manager.DrvgH0Nx.js","sources":["../../../src/components/settings/bank-accounts-manager.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { BankAccountCard } from \"@/components/ui/bank-account-card\";\nimport { Button } from \"@/components/ui/button\";\nimport { BANK_OPTIONS } from \"@/components/banks/bank-badge\";\nimport { Plus, X, Building2 } from \"lucide-react\";\n\ninterface BankAccount {\n  id: string;\n  name: string;\n  bank: string;\n  lastFour: string | null;\n  isDefault: boolean;\n}\n\nexport function BankAccountsManager() {\n  const [accounts, setAccounts] = useState<BankAccount[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showForm, setShowForm] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    bank: \"CHASE\",\n    lastFour: \"\",\n    isDefault: false,\n  });\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  useEffect(() => {\n    fetchAccounts();\n  }, []);\n\n  async function fetchAccounts() {\n    try {\n      const res = await fetch(\"/api/bank-accounts\");\n      if (res.ok) {\n        const data = await res.json();\n        setAccounts(data);\n      }\n    } catch {\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  function resetForm() {\n    setFormData({ name: \"\", bank: \"CHASE\", lastFour: \"\", isDefault: false });\n    setEditingId(null);\n    setShowForm(false);\n    setError(\"\");\n  }\n\n  function handleEdit(id: string) {\n    const account = accounts.find((a) => a.id === id);\n    if (account) {\n      setFormData({\n        name: account.name,\n        bank: account.bank,\n        lastFour: account.lastFour || \"\",\n        isDefault: account.isDefault,\n      });\n      setEditingId(id);\n      setShowForm(true);\n    }\n  }\n\n  async function handleDelete(id: string) {\n    if (!confirm(\"Are you sure you want to delete this bank account?\")) return;\n\n    try {\n      const res = await fetch(`/api/bank-accounts/${id}`, { method: \"DELETE\" });\n      if (res.ok) {\n        setAccounts(accounts.filter((a) => a.id !== id));\n      }\n    } catch {\n      setError(\"Failed to delete account\");\n    }\n  }\n\n  async function handleSetDefault(id: string) {\n    try {\n      const res = await fetch(`/api/bank-accounts/${id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ isDefault: true }),\n      });\n      if (res.ok) {\n        setAccounts(\n          accounts.map((a) => ({\n            ...a,\n            isDefault: a.id === id,\n          }))\n        );\n      }\n    } catch {\n      setError(\"Failed to set default account\");\n    }\n  }\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setError(\"\");\n    setSubmitting(true);\n\n    try {\n      const url = editingId ? `/api/bank-accounts/${editingId}` : \"/api/bank-accounts\";\n      const method = editingId ? \"PATCH\" : \"POST\";\n\n      const res = await fetch(url, {\n        method,\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          name: formData.name,\n          bank: formData.bank,\n          lastFour: formData.lastFour || null,\n          isDefault: formData.isDefault,\n        }),\n      });\n\n      if (!res.ok) {\n        const data = await res.json();\n        throw new Error(data.error || \"Failed to save account\");\n      }\n\n      await fetchAccounts();\n      resetForm();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Something went wrong\");\n    } finally {\n      setSubmitting(false);\n    }\n  }\n\n  const inputClasses =\n    \"w-full px-4 py-2.5 bg-theme-secondary border border-theme rounded-xl text-theme-primary placeholder-theme-muted focus:outline-none focus:ring-2 focus:ring-accent-500/20 focus:border-accent-500\";\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-500\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {accounts.length === 0 && !showForm ? (\n        <div className=\"text-center py-12 bg-gray-50 dark:bg-gray-800/50 rounded-xl border-2 border-dashed border-gray-200 dark:border-gray-700\">\n          <div className=\"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mx-auto mb-4\">\n            <Building2 className=\"h-8 w-8 text-gray-400\" />\n          </div>\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2\">\n            No Bank Accounts Yet\n          </h3>\n          <p className=\"text-gray-500 dark:text-gray-400 mb-4 max-w-sm mx-auto\">\n            Add your bank accounts to track which account each bill comes from and see transfer amounts per account.\n          </p>\n          <Button onClick={() => setShowForm(true)} leftIcon={<Plus className=\"h-4 w-4\" />}>\n            Add Bank Account\n          </Button>\n        </div>\n      ) : (\n        <>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            {accounts.map((account) => (\n              <BankAccountCard\n                key={account.id}\n                id={account.id}\n                name={account.name}\n                bank={account.bank}\n                lastFour={account.lastFour}\n                isDefault={account.isDefault}\n                onEdit={handleEdit}\n                onDelete={handleDelete}\n                onSetDefault={handleSetDefault}\n              />\n            ))}\n          </div>\n\n          {!showForm && (\n            <Button\n              variant=\"secondary\"\n              onClick={() => setShowForm(true)}\n              leftIcon={<Plus className=\"h-4 w-4\" />}\n            >\n              Add Bank Account\n            </Button>\n          )}\n        </>\n      )}\n\n      {showForm && (\n        <div className=\"bg-white dark:bg-[#1c2128] rounded-xl border border-gray-200 dark:border-[#30363d] p-6\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">\n              {editingId ? \"Edit Bank Account\" : \"Add Bank Account\"}\n            </h3>\n            <button\n              onClick={resetForm}\n              className=\"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors\"\n            >\n              <X className=\"h-5 w-5 text-gray-500\" />\n            </button>\n          </div>\n\n          <form onSubmit={handleSubmit} className=\"space-y-5\">\n            {error && (\n              <div className=\"p-3 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 text-sm\">\n                {error}\n              </div>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\n              <div className=\"space-y-2\">\n                <label htmlFor=\"name\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Account Name *\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"name\"\n                  required\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"e.g., Primary Checking\"\n                  className={inputClasses}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"bank\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Bank *\n                </label>\n                <select\n                  id=\"bank\"\n                  required\n                  value={formData.bank}\n                  onChange={(e) => setFormData({ ...formData, bank: e.target.value })}\n                  className={inputClasses}\n                >\n                  {BANK_OPTIONS.map((opt) => (\n                    <option key={opt.value} value={opt.value}>\n                      {opt.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"lastFour\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Last 4 Digits (Optional)\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"lastFour\"\n                  maxLength={4}\n                  pattern=\"[0-9]*\"\n                  value={formData.lastFour}\n                  onChange={(e) => setFormData({ ...formData, lastFour: e.target.value.replace(/\\D/g, \"\") })}\n                  placeholder=\"1234\"\n                  className={inputClasses}\n                />\n              </div>\n\n              <div className=\"flex items-center gap-3 pt-8\">\n                <input\n                  type=\"checkbox\"\n                  id=\"isDefault\"\n                  checked={formData.isDefault}\n                  onChange={(e) => setFormData({ ...formData, isDefault: e.target.checked })}\n                  className=\"h-4 w-4 rounded border-gray-300 text-accent-600 focus:ring-accent-500\"\n                />\n                <label htmlFor=\"isDefault\" className=\"text-sm font-medium text-theme-secondary\">\n                  Set as default account\n                </label>\n              </div>\n            </div>\n\n            <div className=\"flex gap-3 pt-2\">\n              <Button type=\"submit\" disabled={submitting}>\n                {submitting ? \"Saving...\" : editingId ? \"Update Account\" : \"Add Account\"}\n              </Button>\n              <Button type=\"button\" variant=\"secondary\" onClick={resetForm}>\n                Cancel\n              </Button>\n            </div>\n          </form>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["BankAccountsManager","accounts","setAccounts","useState","loading","setLoading","showForm","setShowForm","editingId","setEditingId","formData","setFormData","submitting","setSubmitting","error","setError","useEffect","fetchAccounts","res","data","resetForm","handleEdit","id","account","a","handleDelete","handleSetDefault","handleSubmit","e","url","err","inputClasses","jsx","jsxs","Building2","Button","Plus","Fragment","BankAccountCard","X","BANK_OPTIONS","opt"],"mappings":"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"}