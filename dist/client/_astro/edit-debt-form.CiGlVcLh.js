import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.Cd_vQiNd.js";import{C as D,a as k,b as T,c as R}from"./card.CxXQM9B9.js";import{B as o}from"./button.CwHoT6VS.js";import{B as L}from"./bank-badge.AOlTl-fr.js";import{L as w}from"./loader-circle.k_JR3RqT.js";import{A as q}from"./arrow-left.CGCSNnMn.js";import"./createLucideIcon.DV6VgPWa.js";import"./building-2.CScN-oDP.js";const O=[{value:"CREDIT_CARD",label:"Credit Card"},{value:"AUTO_LOAN",label:"Auto Loan"},{value:"STUDENT_LOAN",label:"Student Loan"},{value:"PERSONAL_LOAN",label:"Personal Loan"},{value:"BNPL",label:"Buy Now Pay Later"},{value:"MORTGAGE",label:"Mortgage"},{value:"OTHER",label:"Other"}],I=[{value:"CURRENT",label:"Current"},{value:"DEFERRED",label:"Deferred"},{value:"PAST_DUE",label:"Past Due"},{value:"IN_COLLECTIONS",label:"In Collections"},{value:"PAID_OFF",label:"Paid Off"}],M=[{value:"weekly",label:"Weekly"},{value:"biweekly",label:"Bi-weekly"},{value:"monthly",label:"Monthly"}];function Q({debtId:d}){const[F,m]=r.useState(!0),[u,h]=r.useState(!1),[x,i]=r.useState(""),[t,P]=r.useState(null),[p,A]=r.useState([]),[b,y]=r.useState(""),[j,g]=r.useState("");r.useEffect(()=>{Promise.all([fetch(`/api/debts/${d}`).then(a=>a.json()),fetch("/api/bank-accounts").then(a=>a.json())]).then(([a,s])=>{a.error?i(a.error):(P(a),y(a.bankAccountId||""),g(a.paymentFrequency||"monthly")),Array.isArray(s)&&A(s),m(!1)}).catch(()=>{i("Failed to load debt"),m(!1)})},[d]);async function C(a){a.preventDefault(),h(!0),i("");const s=new FormData(a.currentTarget),v=s.get("type"),N={name:s.get("name"),type:v,currentBalance:parseFloat(s.get("currentBalance")),originalBalance:parseFloat(s.get("originalBalance")),interestRate:parseFloat(s.get("interestRate")),minimumPayment:parseFloat(s.get("minimumPayment")),dueDay:parseInt(s.get("dueDay"),10),status:s.get("status"),notes:s.get("notes")||null,bankAccountId:b||null};v==="BNPL"&&(N.paymentFrequency=j);const B=await fetch(`/api/debts/${d}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(B.ok){const c=new URL(window.location.href),S=c.searchParams.get("sort")||"name",E=c.searchParams.get("dir")||"asc";window.location.href=`/dashboard/debts?sort=${S}&dir=${E}`}else{const c=await B.json();i(c.error||"Failed to update debt"),h(!1)}}const n="w-full px-4 py-2 bg-theme-secondary border border-theme rounded-xl text-theme-primary placeholder-theme-muted focus:outline-none focus:ring-2 focus:ring-accent-500/20 focus:border-accent-500",l="block text-sm font-medium text-theme-secondary mb-2";if(F)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(w,{className:"h-8 w-8 animate-spin text-accent-500"})});if(!t)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-theme-secondary",children:"Debt not found"}),e.jsx("a",{href:"/dashboard/debts",className:"text-accent-500 hover:underline mt-2 inline-block",children:"Back to debts"})]});const f=t.type==="BNPL";return e.jsxs("div",{className:"animate-fade-in max-w-2xl mx-auto space-y-6 lg:space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("a",{href:"/dashboard/debts",children:e.jsx(o,{variant:"ghost",size:"sm",leftIcon:e.jsx(q,{className:"h-4 w-4"}),children:"Back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-theme-primary",children:"Edit Debt"}),e.jsx("p",{className:"text-theme-secondary mt-1",children:t.name})]})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(T,{children:"Debt Details"})}),e.jsx(R,{children:e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[x&&e.jsx("div",{className:"p-3 rounded-xl bg-danger-50 dark:bg-danger-600/10 border border-danger-200 dark:border-danger-600/30 text-danger-700 dark:text-danger-400 text-sm",children:x}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:l,children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,defaultValue:t.name,className:n})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:l,children:"Type"}),e.jsx("select",{id:"type",name:"type",required:!0,defaultValue:t.type,className:n,children:O.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:l,children:"Status"}),e.jsx("select",{id:"status",name:"status",required:!0,defaultValue:t.status,className:n,children:I.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentBalance",className:l,children:"Current Balance ($)"}),e.jsx("input",{type:"number",id:"currentBalance",name:"currentBalance",required:!0,min:"0",step:"0.01",inputMode:"decimal",defaultValue:t.currentBalance,className:n})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"originalBalance",className:l,children:"Original Balance ($)"}),e.jsx("input",{type:"number",id:"originalBalance",name:"originalBalance",required:!0,min:"0",step:"0.01",inputMode:"decimal",defaultValue:t.originalBalance,className:n})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"interestRate",className:l,children:"Interest Rate (% APR)"}),e.jsx("input",{type:"number",id:"interestRate",name:"interestRate",required:!0,min:"0",max:"100",step:"0.01",inputMode:"decimal",defaultValue:t.interestRate,className:n})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"minimumPayment",className:l,children:f?"Payment Amount ($)":"Minimum Payment ($)"}),e.jsx("input",{type:"number",id:"minimumPayment",name:"minimumPayment",required:!0,min:"0",step:"0.01",inputMode:"decimal",defaultValue:t.minimumPayment,className:n})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dueDay",className:l,children:"Due Day of Month (1-31)"}),e.jsx("input",{type:"number",id:"dueDay",name:"dueDay",required:!0,min:"1",max:"31",defaultValue:t.dueDay,className:n})]}),f&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"paymentFrequency",className:l,children:"Payment Frequency"}),e.jsx("select",{id:"paymentFrequency",name:"paymentFrequency",className:n,value:j,onChange:a=>g(a.target.value),children:M.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),p.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Payment Bank Account"}),e.jsx(L,{value:b,onChange:y,banks:p})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:l,children:"Notes (optional)"}),e.jsx("textarea",{id:"notes",name:"notes",rows:3,defaultValue:t.notes||"",placeholder:"Any additional notes about this debt...",className:n})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(o,{type:"submit",disabled:u,children:u?"Saving...":"Save Changes"}),e.jsx("a",{href:"/dashboard/debts",children:e.jsx(o,{type:"button",variant:"secondary",children:"Cancel"})})]})]})})]})]})}export{Q as default};
//# sourceMappingURL=edit-debt-form.CiGlVcLh.js.map
