{"version":3,"file":"new-bill-form.Dh4nK0DC.js","sources":["../../../src/components/forms/new-bill-form.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { BankSelector } from \"@/components/banks/bank-badge\";\nimport { ArrowLeft } from \"lucide-react\";\n\nconst categories = [\n  { value: \"SUBSCRIPTION\", label: \"Subscription\" },\n  { value: \"UTILITY\", label: \"Utility\" },\n  { value: \"LOAN\", label: \"Loan\" },\n  { value: \"BNPL\", label: \"Buy Now Pay Later\" },\n  { value: \"INSURANCE\", label: \"Insurance\" },\n  { value: \"CREDIT_CARD\", label: \"Credit Card\" },\n  { value: \"OTHER\", label: \"Other\" },\n];\n\nconst frequencies = [\n  { value: \"ONCE\", label: \"One-time\" },\n  { value: \"WEEKLY\", label: \"Weekly\" },\n  { value: \"BIWEEKLY\", label: \"Bi-weekly\" },\n  { value: \"MONTHLY\", label: \"Monthly\" },\n  { value: \"YEARLY\", label: \"Yearly\" },\n];\n\ninterface Debt {\n  id: string;\n  name: string;\n  type: string;\n}\n\ninterface BankAccount {\n  id: string;\n  name: string;\n  bank: string;\n  lastFour: string | null;\n  isDefault?: boolean;\n}\n\nexport default function NewBillForm() {\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [debts, setDebts] = useState<Debt[]>([]);\n  const [bankAccounts, setBankAccounts] = useState<BankAccount[]>([]);\n  const [selectedBankAccountId, setSelectedBankAccountId] = useState(\"\");\n\n  const [formData, setFormData] = useState({\n    name: \"\",\n    category: \"OTHER\",\n    amount: \"\",\n    dueDay: \"\",\n    isRecurring: true,\n    frequency: \"MONTHLY\",\n    debtId: \"\",\n    notes: \"\",\n  });\n\n  useEffect(() => {\n    Promise.all([\n      fetch(\"/api/debts\").then((res) => res.json()),\n      fetch(\"/api/bank-accounts\").then((res) => res.json()),\n    ])\n      .then(([debtsData, accountsData]) => {\n        if (Array.isArray(debtsData)) {\n          setDebts(debtsData);\n        }\n        if (Array.isArray(accountsData)) {\n          setBankAccounts(accountsData);\n          const defaultAccount = accountsData.find((a: BankAccount) => a.isDefault);\n          if (defaultAccount) {\n            setSelectedBankAccountId(defaultAccount.id);\n          }\n        }\n      })\n      .catch(() => {});\n  }, []);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    setIsSubmitting(true);\n\n    try {\n      const res = await fetch(\"/api/bills\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          ...formData,\n          bankAccountId: selectedBankAccountId || null,\n        }),\n      });\n\n      if (!res.ok) {\n        const data = await res.json();\n        throw new Error(data.error || \"Failed to create bill\");\n      }\n\n      window.location.href = \"/dashboard/bills\";\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Something went wrong\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleChange = (\n    e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>\n  ) => {\n    const { name, value, type } = e.target;\n    setFormData((prev) => ({\n      ...prev,\n      [name]: type === \"checkbox\" ? (e.target as HTMLInputElement).checked : value,\n    }));\n  };\n\n  const inputClasses =\n    \"w-full px-4 py-2 bg-theme-secondary border border-theme rounded-xl text-theme-primary placeholder-theme-muted focus:outline-none focus:ring-2 focus:ring-accent-500/20 focus:border-accent-500\";\n\n  return (\n    <div className=\"animate-fade-in space-y-6 lg:space-y-8\">\n      <div className=\"flex items-center gap-4\">\n        <a href=\"/dashboard/bills\">\n          <Button variant=\"ghost\" size=\"sm\" leftIcon={<ArrowLeft className=\"h-4 w-4\" />}>\n            Back\n          </Button>\n        </a>\n        <div>\n          <h1 className=\"text-2xl font-bold text-theme-primary\">Add New Bill</h1>\n          <p className=\"text-theme-secondary mt-1\">Create a new recurring bill or payment</p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Bill Details</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {error && (\n              <div className=\"p-3 rounded-xl bg-danger-50 dark:bg-danger-600/10 border border-danger-200 dark:border-danger-600/30 text-danger-700 dark:text-danger-400 text-sm\">\n                {error}\n              </div>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"space-y-2\">\n                <label htmlFor=\"name\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Name *\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"name\"\n                  name=\"name\"\n                  required\n                  autoFocus\n                  value={formData.name}\n                  onChange={handleChange}\n                  placeholder=\"e.g., Netflix, Electric Bill\"\n                  className={inputClasses}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"category\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Category\n                </label>\n                <select\n                  id=\"category\"\n                  name=\"category\"\n                  value={formData.category}\n                  onChange={handleChange}\n                  className={inputClasses}\n                >\n                  {categories.map((cat) => (\n                    <option key={cat.value} value={cat.value}>\n                      {cat.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"amount\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Amount *\n                </label>\n                <div className=\"relative\">\n                  <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-theme-muted\">$</span>\n                  <input\n                    type=\"number\"\n                    id=\"amount\"\n                    name=\"amount\"\n                    required\n                    min=\"0\"\n                    step=\"0.01\"\n                    inputMode=\"decimal\"\n                    value={formData.amount}\n                    onChange={handleChange}\n                    placeholder=\"0.00\"\n                    className={`${inputClasses} pl-8`}\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"dueDay\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Due Day (1-31) *\n                </label>\n                <input\n                  type=\"number\"\n                  id=\"dueDay\"\n                  name=\"dueDay\"\n                  required\n                  min=\"1\"\n                  max=\"31\"\n                  value={formData.dueDay}\n                  onChange={handleChange}\n                  placeholder=\"15\"\n                  className={inputClasses}\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <input\n                type=\"checkbox\"\n                id=\"isRecurring\"\n                name=\"isRecurring\"\n                checked={formData.isRecurring}\n                onChange={handleChange}\n                className=\"h-4 w-4 rounded border-theme bg-theme-secondary text-accent-600 focus:ring-accent-500 focus:ring-offset-theme-primary\"\n              />\n              <label htmlFor=\"isRecurring\" className=\"text-sm font-medium text-theme-secondary\">\n                This is a recurring bill\n              </label>\n            </div>\n\n            {formData.isRecurring && (\n              <div className=\"space-y-2\">\n                <label htmlFor=\"frequency\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Frequency\n                </label>\n                <select\n                  id=\"frequency\"\n                  name=\"frequency\"\n                  value={formData.frequency}\n                  onChange={handleChange}\n                  className={inputClasses}\n                >\n                  {frequencies.map((freq) => (\n                    <option key={freq.value} value={freq.value}>\n                      {freq.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n\n            {debts.length > 0 && (\n              <div className=\"space-y-2\">\n                <label htmlFor=\"debtId\" className=\"block text-sm font-medium text-theme-secondary\">\n                  Link to Debt Account (Optional)\n                </label>\n                <select\n                  id=\"debtId\"\n                  name=\"debtId\"\n                  value={formData.debtId}\n                  onChange={handleChange}\n                  className={inputClasses}\n                >\n                  <option value=\"\">None</option>\n                  {debts.map((debt) => (\n                    <option key={debt.id} value={debt.id}>\n                      {debt.name} ({debt.type.toLowerCase().replace(\"_\", \" \")})\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n\n            {bankAccounts.length > 0 && (\n              <div className=\"space-y-2\">\n                <label className=\"block text-sm font-medium text-theme-secondary\">\n                  Payment Bank Account\n                </label>\n                <BankSelector\n                  value={selectedBankAccountId}\n                  onChange={setSelectedBankAccountId}\n                  banks={bankAccounts}\n                />\n              </div>\n            )}\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-theme-secondary\">\n                Notes (Optional)\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                placeholder=\"Any additional notes about this bill...\"\n                className={`${inputClasses} resize-none`}\n              />\n            </div>\n\n            <div className=\"flex gap-4 pt-4\">\n              <Button type=\"submit\" disabled={isSubmitting}>\n                {isSubmitting ? \"Creating...\" : \"Create Bill\"}\n              </Button>\n              <a href=\"/dashboard/bills\">\n                <Button type=\"button\" variant=\"secondary\">\n                  Cancel\n                </Button>\n              </a>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":["categories","frequencies","NewBillForm","isSubmitting","setIsSubmitting","useState","error","setError","debts","setDebts","bankAccounts","setBankAccounts","selectedBankAccountId","setSelectedBankAccountId","formData","setFormData","useEffect","res","debtsData","accountsData","defaultAccount","a","handleSubmit","e","data","err","handleChange","name","value","type","prev","inputClasses","jsxs","jsx","Button","ArrowLeft","Card","CardHeader","CardTitle","CardContent","cat","freq","debt","BankSelector"],"mappings":"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"}