import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.Cd_vQiNd.js";import{C as L,a as Z,b as ee,c as E,S as $}from"./card.CxXQM9B9.js";import{B as k}from"./button.9NTnJrUv.js";import{P as I,S as te,F,a as se,T as ae}from"./search-input.CPuWM8fb.js";import{C as _,a as ne}from"./credit-card.Cdk-0iNQ.js";import{c as j}from"./createLucideIcon.DV6VgPWa.js";import"./search.B65NY9Yq.js";import"./x.DGcJ3xm4.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ce=j("arrow-up-down",re);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],oe=j("banknote",ie);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],de=j("car",le);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],he=j("circle-alert",me);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],xe=j("dollar-sign",ue);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],ye=j("graduation-cap",fe);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Ne=j("house",pe);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],je=j("trending-down",ge);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],we=j("wallet",be);function ve({debtId:n,debtName:b,currentBalance:D,minimumPayment:f,onClose:h}){const[P,d]=l.useState(f.toString()),[y,C]=l.useState(new Date().toISOString().split("T")[0]),[p,N]=l.useState(""),[i,c]=l.useState(!1),[w,o]=l.useState("");async function B(u){u.preventDefault(),c(!0),o("");const T=await fetch(`/api/debts/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(P),date:y,notes:p})});if(T.ok)window.location.reload(),h();else{const A=await T.json();o(A.error||"Failed to log payment")}c(!1)}return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(L,{className:"w-full max-w-md",children:[e.jsx(Z,{children:e.jsxs(ee,{children:["Log Payment - ",b]})}),e.jsx(E,{children:e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-theme-secondary mb-1",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",max:D,value:P,onChange:u=>d(u.target.value),className:"w-full px-3 py-2 bg-theme-secondary border border-theme rounded-lg text-theme-primary focus:outline-none focus:ring-2 focus:ring-accent-500",required:!0}),e.jsxs("p",{className:"text-xs text-theme-muted mt-1",children:["Current balance: $",D.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-theme-secondary mb-1",children:"Date"}),e.jsx("input",{type:"date",value:y,onChange:u=>C(u.target.value),className:"w-full px-3 py-2 bg-theme-secondary border border-theme rounded-lg text-theme-primary focus:outline-none focus:ring-2 focus:ring-accent-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-theme-secondary mb-1",children:"Notes (optional)"}),e.jsx("textarea",{value:p,onChange:u=>N(u.target.value),rows:2,className:"w-full px-3 py-2 bg-theme-secondary border border-theme rounded-lg text-theme-primary focus:outline-none focus:ring-2 focus:ring-accent-500 resize-none"})]}),w&&e.jsx("p",{className:"text-red-400 text-sm",children:w}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(k,{type:"button",variant:"secondary",onClick:h,className:"flex-1",children:"Cancel"}),e.jsx(k,{type:"submit",disabled:i,className:"flex-1",children:i?"Saving...":"Log Payment"})]})]})})]})})}const De={CREDIT_CARD:"Credit Card",AUTO_LOAN:"Auto Loan",STUDENT_LOAN:"Student Loan",PERSONAL_LOAN:"Personal Loan",BNPL:"BNPL",MORTGAGE:"Mortgage",OTHER:"Other"},Pe={CREDIT_CARD:_,AUTO_LOAN:de,STUDENT_LOAN:ye,PERSONAL_LOAN:oe,BNPL:ne,MORTGAGE:Ne,OTHER:F},Se={CURRENT:"Current",DEFERRED:"Deferred",PAST_DUE:"Past Due",IN_COLLECTIONS:"In Collections",PAID_OFF:"Paid Off"};function v(n){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Number(n))}function ke(n){const b=Number(n.currentBalance),D=Number(n.interestRate),f=Number(n.minimumPayment),h=n.type==="BNPL",P=n.status==="DEFERRED";if(h&&n.scheduledPayments&&n.scheduledPayments.length>0){const i=n.scheduledPayments.filter(o=>!o.isPaid);if(i.length===0)return{months:0,date:"Paid Off",method:"fixed"};const c=i[i.length-1],w=new Date(c.dueDate);return{months:i.length,date:w.toLocaleDateString("en-US",{month:"short",year:"numeric"}),method:"fixed"}}if(f<=0||b<=0)return{months:null,date:"N/A",method:"standard"};let d=b;if(P&&n.deferredUntil){const i=new Date(n.deferredUntil),c=new Date;if(i>c){const w=Math.ceil((i.getTime()-c.getTime())/2592e6),o=D/100/12;d=b*Math.pow(1+o,w)}}const y=D/100/12;if(y===0){const i=Math.ceil(d/f),c=new Date;return c.setMonth(c.getMonth()+i),{months:i,date:c.toLocaleDateString("en-US",{month:"short",year:"numeric"}),method:"no-interest"}}const C=d*y;if(f<=C)return{months:null,date:"Never (payment too low)",method:"standard"};const p=Math.ceil(Math.log(f/(f-d*y))/Math.log(1+y)),N=new Date;return N.setMonth(N.getMonth()+p),{months:p,date:N.toLocaleDateString("en-US",{month:"short",year:"numeric"}),method:"amortized"}}function Oe(){const[n,b]=l.useState([]),[D,f]=l.useState(!0),[h,P]=l.useState(null),[d,y]=l.useState(""),C=typeof window<"u"?new URLSearchParams(window.location.search):null,p=C?.get("sort"),N=C?.get("dir"),i=["name","interestRate","effectiveRate","currentBalance","dueDay","status"],[c,w]=l.useState(p&&i.includes(p)?p:"effectiveRate"),[o,B]=l.useState(N==="asc"||N==="desc"?N:"desc");l.useEffect(()=>{u()},[]);async function u(){const t=await fetch("/api/debts");if(t.ok){const s=await t.json(),a=await Promise.all(s.map(async r=>{const[m,g]=await Promise.all([fetch(`/api/debts/${r.id}/payments`),fetch(`/api/debts/${r.id}/scheduled-payments`)]),x=m.ok?await m.json():[],R=g.ok?await g.json():[];return{...r,payments:x,scheduledPayments:R}}));b(a)}f(!1)}function T(t){let s;c===t?s=o==="asc"?"desc":"asc":s=t==="name"?"asc":"desc",w(t),B(s);const a=new URLSearchParams(window.location.search);a.set("sort",t),a.set("dir",s),window.history.replaceState({},"",`/dashboard/debts?${a.toString()}`)}const A=n.filter(t=>{if(!d)return!0;const s=d.toLowerCase();return t.name.toLowerCase().includes(s)||t.type.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||(t.notes?.toLowerCase().includes(s)??!1)}),q=[...A].sort((t,s)=>{let a,r;switch(c){case"name":const m=t.name.localeCompare(s.name,void 0,{numeric:!0,sensitivity:"base"});return o==="asc"?m:-m;case"interestRate":a=Number(t.interestRate),r=Number(s.interestRate);break;case"effectiveRate":a=Math.max(Number(t.effectiveRate)||0,Number(t.interestRate)||0),r=Math.max(Number(s.effectiveRate)||0,Number(s.interestRate)||0);break;case"currentBalance":a=Number(t.currentBalance),r=Number(s.currentBalance);break;case"dueDay":a=t.dueDay,r=s.dueDay;break;case"status":a=t.status,r=s.status;break;default:return 0}return a<r?o==="asc"?-1:1:a>r?o==="asc"?1:-1:0});function z(){P(null),u()}async function H(t){if(!confirm("Are you sure you want to delete this debt?"))return;(await fetch(`/api/debts/${t}`,{method:"DELETE"})).ok&&b(n.filter(a=>a.id!==t))}const G=n.reduce((t,s)=>t+Number(s.currentBalance),0),V=n.filter(t=>t.type!=="BNPL"),Y=n.filter(t=>t.type==="BNPL"),Q=V.reduce((t,s)=>t+Number(s.minimumPayment),0),W=Y.reduce((t,s)=>{if(s.scheduledPayments&&s.scheduledPayments.length>0){const a=s.scheduledPayments.filter(x=>!x.isPaid);if(a.length===0)return t;const r=new Date,m=new Date(r.getTime()+720*60*60*1e3),g=a.filter(x=>new Date(x.dueDate)<=m);return t+g.reduce((x,R)=>x+Number(R.amount),0)}return t},0);if(D)return e.jsxs("div",{className:"space-y-6 lg:space-y-8 animate-fade-in",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-theme-primary tracking-tight",children:"Debts"}),e.jsx("p",{className:"text-theme-secondary mt-1",children:"Track and manage your debts"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(t=>e.jsx(L,{children:e.jsx(E,{className:"py-5",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 w-24 bg-theme-tertiary rounded"}),e.jsx("div",{className:"h-8 w-32 bg-theme-tertiary rounded"})]})})},t))})]});const M=({field:t,label:s})=>e.jsxs("button",{onClick:()=>T(t),className:`
        flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium
        transition-all duration-200
        ${c===t?"bg-accent-600 text-white shadow-sm":"bg-theme-tertiary text-theme-secondary hover:bg-theme-secondary hover:text-theme-primary"}
      `,children:[s,e.jsx(ce,{className:"h-3 w-3"})]});return e.jsxs("div",{className:"space-y-6 lg:space-y-8 animate-fade-in",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-theme-primary tracking-tight",children:"Debts"}),e.jsx("p",{className:"text-theme-secondary mt-1",children:"Track and manage your debts"})]}),e.jsx("a",{href:"/dashboard/debts/new",children:e.jsx(k,{leftIcon:e.jsx(I,{className:"h-4 w-4"}),children:"Add Debt"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx($,{label:"Total Debt",value:v(G),icon:e.jsx(_,{className:"h-5 w-5"}),variant:"danger"}),e.jsx($,{label:"Monthly Payments",value:v(Q),icon:e.jsx(we,{className:"h-5 w-5"}),variant:"info"}),e.jsx($,{label:"BNPL Due This Month",value:v(W),icon:e.jsx(je,{className:"h-5 w-5"}),variant:"warning"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(te,{value:d,onChange:y,placeholder:"Search debts...",className:"sm:max-w-xs"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-theme-secondary text-sm font-medium",children:"Sort:"}),e.jsx(M,{field:"effectiveRate",label:"Effective Rate"}),e.jsx(M,{field:"interestRate",label:"APR"}),e.jsx(M,{field:"currentBalance",label:"Balance"}),e.jsx(M,{field:"name",label:"Name"})]})]}),n.length===0?e.jsx(L,{children:e.jsxs(E,{className:"py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-theme-tertiary flex items-center justify-center mx-auto mb-4",children:e.jsx(_,{className:"h-8 w-8 text-theme-muted"})}),e.jsx("h3",{className:"text-lg font-semibold text-theme-primary mb-2",children:"No debts yet"}),e.jsx("p",{className:"text-theme-secondary mb-6",children:"Start tracking your debts to monitor your progress"}),e.jsx("a",{href:"/dashboard/debts/new",children:e.jsx(k,{leftIcon:e.jsx(I,{className:"h-4 w-4"}),children:"Add Your First Debt"})})]})}):A.length===0?e.jsx(L,{children:e.jsxs(E,{className:"py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-theme-tertiary flex items-center justify-center mx-auto mb-4",children:e.jsx(_,{className:"h-8 w-8 text-theme-muted"})}),e.jsx("h3",{className:"text-lg font-semibold text-theme-primary mb-2",children:"No results found"}),e.jsxs("p",{className:"text-theme-secondary",children:['No debts match "',d,'"']})]})}):e.jsx("div",{className:"space-y-3",children:q.map((t,s)=>{const a=Number(t.currentBalance),r=Number(t.originalBalance),m=Number(t.interestRate),g=Number(t.effectiveRate)||0,x=Math.max(g,m),R=r>0?(r-a)/r*100:0,J=ke(t),O=t.type==="BNPL",K=O&&g>0&&g!==m,X=Pe[t.type]||F,U=t.status==="PAST_DUE"||t.status==="IN_COLLECTIONS";return e.jsx(L,{className:`animate-fade-in-up stagger-${Math.min(s+1,5)} ${U?"border-danger-300 dark:border-danger-600/50 bg-danger-50/50 dark:bg-danger-600/5":""}`,children:e.jsxs(E,{className:"py-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2.5 rounded-lg bg-theme-tertiary shrink-0",children:e.jsx(X,{className:"h-5 w-5 text-theme-secondary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("a",{href:`/dashboard/debts/${t.id}`,className:"group",children:e.jsx("h3",{className:"font-semibold text-theme-primary group-hover:text-accent-600 transition-colors truncate",children:t.name})}),e.jsxs("p",{className:"text-sm text-theme-muted",children:[De[t.type]||t.type,x>0&&` · ${K?`~${g.toFixed(1)}%`:`${m}%`} APR`,O&&x===0&&" · 0% APR",t.status!=="CURRENT"&&` · ${Se[t.status]}`]})]}),e.jsx("div",{className:"text-right shrink-0",children:U?e.jsxs("div",{className:"px-3 py-1.5 rounded-lg bg-danger-100 dark:bg-danger-600/20 border border-danger-200 dark:border-danger-600/30",children:[e.jsx("p",{className:"text-lg font-bold text-danger-700 dark:text-danger-400",children:v(a)}),t.pastDueAmount?e.jsxs("p",{className:"text-xs text-danger-600 dark:text-danger-400 font-medium",children:[v(Number(t.pastDueAmount))," PAST DUE"]}):e.jsx("p",{className:"text-xs text-danger-600 dark:text-danger-400",children:"PAST DUE"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-lg font-bold text-theme-primary",children:v(a)}),e.jsxs("p",{className:"text-xs text-theme-muted",children:[v(Number(t.minimumPayment)),"/mo"]})]})}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx(k,{size:"sm",variant:"ghost",onClick:()=>P(t),children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx("a",{href:`/dashboard/debts/${t.id}/edit?sort=${c}&dir=${o}`,children:e.jsx(k,{variant:"ghost",size:"sm",children:e.jsx(se,{className:"h-4 w-4"})})}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>H(t.id),children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-theme-muted mb-1.5",children:[e.jsxs("span",{children:[R.toFixed(0),"% paid off"]}),e.jsxs("span",{children:["Payoff: ",J.date]})]}),e.jsx("div",{className:"progress-bar h-1.5",children:e.jsx("div",{className:"progress-bar-fill",style:{width:`${Math.min(R,100)}%`}})})]}),O&&t.scheduledPayments&&t.scheduledPayments.filter(S=>!S.isPaid).length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t border-theme",children:e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsx("span",{className:"text-theme-muted",children:"Next payments:"}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:t.scheduledPayments.filter(S=>!S.isPaid).slice(0,3).map(S=>e.jsxs("span",{className:"text-theme-secondary",children:[new Date(S.dueDate).toLocaleDateString("en-US",{month:"short",day:"numeric"}),e.jsx("span",{className:"text-theme-primary font-medium ml-1",children:v(Number(S.amount))})]},S.id))})]})}),t.status==="DEFERRED"&&t.deferredUntil&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-sm text-theme-muted",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsxs("span",{children:["Deferred until ",new Date(t.deferredUntil).toLocaleDateString()]})]})]})},t.id)})}),h&&e.jsx(ve,{debtId:h.id,debtName:h.name,currentBalance:Number(h.currentBalance),minimumPayment:Number(h.minimumPayment),onClose:z})]})}export{Oe as default};
//# sourceMappingURL=debts-page-content.DxxEb8aa.js.map
