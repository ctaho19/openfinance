{"version":3,"file":"new-debt-form.DkAnEU6p.js","sources":["../../../src/lib/bnpl-utils.ts","../../../src/components/forms/new-debt-form.tsx"],"sourcesContent":["export interface BNPLSchedule {\n  totalAmount: number;\n  numberOfPayments: number;\n  firstPaymentDate: Date;\n  frequency: 'weekly' | 'biweekly' | 'monthly';\n}\n\nexport interface PaymentScheduleResult {\n  paymentAmount: number;\n  paymentDates: Date[];\n}\n\nexport function generatePaymentSchedule(schedule: BNPLSchedule): PaymentScheduleResult {\n  const paymentAmount = Math.round((schedule.totalAmount / schedule.numberOfPayments) * 100) / 100;\n  const paymentDates: Date[] = [];\n\n  for (let i = 0; i < schedule.numberOfPayments; i++) {\n    const date = new Date(schedule.firstPaymentDate);\n    \n    switch (schedule.frequency) {\n      case 'weekly':\n        date.setDate(date.getDate() + (i * 7));\n        break;\n      case 'biweekly':\n        date.setDate(date.getDate() + (i * 14));\n        break;\n      case 'monthly':\n        date.setMonth(date.getMonth() + i);\n        break;\n    }\n    \n    paymentDates.push(date);\n  }\n\n  return { paymentAmount, paymentDates };\n}\n\nexport function formatPaymentPreview(\n  numberOfPayments: number,\n  paymentAmount: number,\n  firstPaymentDate: Date\n): string {\n  const formatter = new Intl.DateTimeFormat('en-US', { month: 'short', day: 'numeric' });\n  return `${numberOfPayments} payments of $${paymentAmount.toFixed(2)} starting ${formatter.format(firstPaymentDate)}`;\n}\n\n/**\n * Calculate effective APR from a BNPL payment schedule.\n * This computes the implied interest rate when total repayable differs from principal.\n * \n * Uses a simple APR approximation: ((totalRepayable - principal) / principal) * (12 / months) * 100\n * For more accuracy, we could use Newton-Raphson to solve for IRR, but this is sufficient for display.\n */\nexport function calculateEffectiveAPR(params: {\n  principal: number;\n  totalRepayable: number;\n  numberOfPayments: number;\n  frequency: 'weekly' | 'biweekly' | 'monthly';\n}): number {\n  const { principal, totalRepayable, numberOfPayments, frequency } = params;\n  \n  if (principal <= 0 || totalRepayable <= 0 || numberOfPayments <= 0) {\n    return 0;\n  }\n  \n  // If no interest (total equals principal), return 0\n  if (Math.abs(totalRepayable - principal) < 0.01) {\n    return 0;\n  }\n  \n  // Calculate total finance charge\n  const financeCharge = totalRepayable - principal;\n  \n  // Determine loan term in months based on frequency\n  let termInMonths: number;\n  switch (frequency) {\n    case 'weekly':\n      termInMonths = (numberOfPayments * 7) / 30.44; // Average days per month\n      break;\n    case 'biweekly':\n      termInMonths = (numberOfPayments * 14) / 30.44;\n      break;\n    case 'monthly':\n      termInMonths = numberOfPayments;\n      break;\n  }\n  \n  // Simple APR approximation\n  // APR = (Finance Charge / Principal) / (Term in Years) * 100\n  const termInYears = termInMonths / 12;\n  const effectiveAPR = (financeCharge / principal) / termInYears * 100;\n  \n  // Round to 2 decimal places\n  return Math.round(effectiveAPR * 100) / 100;\n}\n\n/**\n * Calculate the \"effective rate\" to use for sorting/prioritization.\n * Returns the higher of stated APR or computed effective APR.\n */\nexport function getEffectiveRateForSorting(params: {\n  statedAPR: number;\n  principal: number;\n  totalRepayable: number;\n  numberOfPayments: number;\n  frequency: 'weekly' | 'biweekly' | 'monthly';\n}): number {\n  const computedAPR = calculateEffectiveAPR({\n    principal: params.principal,\n    totalRepayable: params.totalRepayable,\n    numberOfPayments: params.numberOfPayments,\n    frequency: params.frequency,\n  });\n  \n  // Use whichever is higher - stated or computed\n  return Math.max(params.statedAPR, computedAPR);\n}\n","import { useState, useMemo, useEffect } from \"react\";\nimport { Card, CardHeader, CardTitle, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { formatPaymentPreview, calculateEffectiveAPR } from \"@/lib/bnpl-utils\";\nimport { BankSelector } from \"@/components/banks/bank-badge\";\nimport { ArrowLeft } from \"lucide-react\";\n\nconst DEBT_TYPES = [\n  { value: \"CREDIT_CARD\", label: \"Credit Card\" },\n  { value: \"AUTO_LOAN\", label: \"Auto Loan\" },\n  { value: \"STUDENT_LOAN\", label: \"Student Loan\" },\n  { value: \"PERSONAL_LOAN\", label: \"Personal Loan\" },\n  { value: \"BNPL\", label: \"Buy Now Pay Later\" },\n  { value: \"MORTGAGE\", label: \"Mortgage\" },\n  { value: \"OTHER\", label: \"Other\" },\n];\n\nconst PAYMENT_COUNTS = [2, 3, 4, 5, 6, 8, 10, 12, 18, 24, 36, 48, 60];\n\nconst PAYMENT_FREQUENCIES = [\n  { value: \"weekly\", label: \"Weekly\" },\n  { value: \"biweekly\", label: \"Bi-weekly\" },\n  { value: \"monthly\", label: \"Monthly\" },\n];\n\ninterface BankAccount {\n  id: string;\n  name: string;\n  bank: string;\n  lastFour: string | null;\n  isDefault?: boolean;\n}\n\nexport default function NewDebtForm() {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [debtType, setDebtType] = useState(\"\");\n  const [currentBalance, setCurrentBalance] = useState(\"\");\n  const [numberOfPayments, setNumberOfPayments] = useState(\"4\");\n  const [customPayments, setCustomPayments] = useState(\"\");\n  const [firstPaymentDate, setFirstPaymentDate] = useState(\"\");\n  const [paymentFrequency, setPaymentFrequency] = useState(\"monthly\");\n  const [bankAccounts, setBankAccounts] = useState<BankAccount[]>([]);\n  const [selectedBankAccountId, setSelectedBankAccountId] = useState(\"\");\n  const [totalRepayable, setTotalRepayable] = useState(\"\");\n  const [interestRate, setInterestRate] = useState(\"\");\n  const [bnplHasInterest, setBnplHasInterest] = useState(false);\n\n  const isBNPL = debtType === \"BNPL\";\n\n  useEffect(() => {\n    fetch(\"/api/bank-accounts\")\n      .then((res) => res.json())\n      .then((data) => {\n        if (Array.isArray(data)) {\n          setBankAccounts(data);\n          const defaultAccount = data.find((a: BankAccount) => a.isDefault);\n          if (defaultAccount) {\n            setSelectedBankAccountId(defaultAccount.id);\n          }\n        }\n      })\n      .catch(() => {});\n  }, []);\n\n  const effectivePaymentCount = customPayments ? parseInt(customPayments, 10) : parseInt(numberOfPayments, 10);\n\n  const paymentPreview = useMemo(() => {\n    if (!isBNPL || !currentBalance || !effectivePaymentCount || !firstPaymentDate) {\n      return null;\n    }\n    const balance = parseFloat(currentBalance);\n    if (isNaN(balance) || isNaN(effectivePaymentCount) || balance <= 0 || effectivePaymentCount <= 0) {\n      return null;\n    }\n    const total = totalRepayable ? parseFloat(totalRepayable) : balance;\n    const paymentAmount = Math.round((total / effectivePaymentCount) * 100) / 100;\n    return formatPaymentPreview(effectivePaymentCount, paymentAmount, new Date(firstPaymentDate + \"T00:00:00\"));\n  }, [isBNPL, currentBalance, totalRepayable, effectivePaymentCount, firstPaymentDate]);\n\n  const computedEffectiveAPR = useMemo(() => {\n    if (!isBNPL || !currentBalance || !effectivePaymentCount) return null;\n    const principal = parseFloat(currentBalance);\n    const total = totalRepayable ? parseFloat(totalRepayable) : principal;\n    if (isNaN(principal) || isNaN(total) || principal <= 0 || total <= 0) return null;\n    if (Math.abs(total - principal) < 0.01) return null;\n    \n    return calculateEffectiveAPR({\n      principal,\n      totalRepayable: total,\n      numberOfPayments: effectivePaymentCount,\n      frequency: paymentFrequency as 'weekly' | 'biweekly' | 'monthly',\n    });\n  }, [isBNPL, currentBalance, totalRepayable, effectivePaymentCount, paymentFrequency]);\n\n  async function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n    e.preventDefault();\n    setLoading(true);\n    setError(\"\");\n\n    const formData = new FormData(e.currentTarget);\n    \n    const balance = parseFloat(formData.get(\"currentBalance\") as string);\n    const total = isBNPL && totalRepayable ? parseFloat(totalRepayable) : balance;\n    const paymentAmount = isBNPL && effectivePaymentCount > 0 \n      ? Math.round((total / effectivePaymentCount) * 100) / 100\n      : parseFloat(formData.get(\"minimumPayment\") as string);\n\n    const statedInterestRate = isBNPL \n      ? (bnplHasInterest && interestRate ? parseFloat(interestRate) : 0)\n      : parseFloat(formData.get(\"interestRate\") as string);\n\n    const dueDay = isBNPL && firstPaymentDate\n      ? new Date(firstPaymentDate + \"T00:00:00\").getDate()\n      : parseInt(formData.get(\"dueDay\") as string, 10);\n\n    const data: Record<string, unknown> = {\n      name: formData.get(\"name\"),\n      type: formData.get(\"type\"),\n      currentBalance: balance,\n      originalBalance: parseFloat(formData.get(\"originalBalance\") as string),\n      interestRate: statedInterestRate,\n      minimumPayment: paymentAmount,\n      dueDay,\n      notes: formData.get(\"notes\") || null,\n    };\n\n    if (isBNPL) {\n      data.numberOfPayments = effectivePaymentCount;\n      data.firstPaymentDate = firstPaymentDate;\n      data.paymentFrequency = paymentFrequency;\n      if (totalRepayable && parseFloat(totalRepayable) !== balance) {\n        data.totalRepayable = parseFloat(totalRepayable);\n      }\n    }\n\n    if (selectedBankAccountId) {\n      data.bankAccountId = selectedBankAccountId;\n    }\n\n    const res = await fetch(\"/api/debts\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n    });\n\n    if (res.ok) {\n      window.location.href = \"/dashboard/debts\";\n    } else {\n      const result = await res.json();\n      setError(result.error || \"Failed to create debt\");\n      setLoading(false);\n    }\n  }\n\n  const inputClasses =\n    \"w-full px-4 py-2 bg-theme-secondary border border-theme rounded-xl text-theme-primary placeholder-theme-muted focus:outline-none focus:ring-2 focus:ring-accent-500/20 focus:border-accent-500\";\n  const labelClasses = \"block text-sm font-medium text-theme-secondary mb-2\";\n\n  return (\n    <div className=\"animate-fade-in max-w-2xl mx-auto space-y-6 lg:space-y-8\">\n      <div className=\"flex items-center gap-4\">\n        <a href=\"/dashboard/debts\">\n          <Button variant=\"ghost\" size=\"sm\" leftIcon={<ArrowLeft className=\"h-4 w-4\" />}>\n            Back\n          </Button>\n        </a>\n        <div>\n          <h1 className=\"text-2xl font-bold text-theme-primary\">Add New Debt</h1>\n          <p className=\"text-theme-secondary mt-1\">Track a new debt account</p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Debt Details</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {error && (\n              <div className=\"p-3 rounded-xl bg-danger-50 dark:bg-danger-600/10 border border-danger-200 dark:border-danger-600/30 text-danger-700 dark:text-danger-400 text-sm\">\n                {error}\n              </div>\n            )}\n\n            <div>\n              <label htmlFor=\"name\" className={labelClasses}>\n                Name\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                required\n                autoFocus\n                placeholder=\"e.g., Chase Sapphire or Affirm - Laptop\"\n                className={inputClasses}\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"type\" className={labelClasses}>\n                Type\n              </label>\n              <select\n                id=\"type\"\n                name=\"type\"\n                required\n                className={inputClasses}\n                value={debtType}\n                onChange={(e) => setDebtType(e.target.value)}\n              >\n                <option value=\"\">Select type...</option>\n                {DEBT_TYPES.map((type) => (\n                  <option key={type.value} value={type.value}>\n                    {type.label}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label htmlFor=\"currentBalance\" className={labelClasses}>\n                  {isBNPL ? \"Total Amount ($)\" : \"Current Balance ($)\"}\n                </label>\n                <input\n                  type=\"number\"\n                  id=\"currentBalance\"\n                  name=\"currentBalance\"\n                  required\n                  min=\"0\"\n                  step=\"0.01\"\n                  inputMode=\"decimal\"\n                  placeholder={isBNPL ? \"1200.00\" : \"5000.00\"}\n                  className={inputClasses}\n                  value={currentBalance}\n                  onChange={(e) => setCurrentBalance(e.target.value)}\n                />\n              </div>\n\n              <div>\n                <label htmlFor=\"originalBalance\" className={labelClasses}>\n                  Original Balance ($)\n                </label>\n                <input\n                  type=\"number\"\n                  id=\"originalBalance\"\n                  name=\"originalBalance\"\n                  required\n                  min=\"0\"\n                  step=\"0.01\"\n                  inputMode=\"decimal\"\n                  placeholder={isBNPL ? currentBalance || \"1200.00\" : \"10000.00\"}\n                  defaultValue={isBNPL ? currentBalance : \"\"}\n                  className={inputClasses}\n                />\n              </div>\n            </div>\n\n            {isBNPL && (\n              <div className=\"p-4 bg-theme-tertiary border border-theme rounded-xl space-y-4\">\n                <h3 className=\"text-sm font-medium text-accent\">BNPL Payment Schedule</h3>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div>\n                    <label htmlFor=\"numberOfPayments\" className={labelClasses}>\n                      Number of Payments\n                    </label>\n                    <select\n                      id=\"numberOfPayments\"\n                      name=\"numberOfPayments\"\n                      className={inputClasses}\n                      value={numberOfPayments}\n                      onChange={(e) => {\n                        setNumberOfPayments(e.target.value);\n                        setCustomPayments(\"\");\n                      }}\n                    >\n                      {PAYMENT_COUNTS.map((count) => (\n                        <option key={count} value={count}>\n                          {count} payments\n                        </option>\n                      ))}\n                    </select>\n                    <div className=\"mt-2\">\n                      <input\n                        type=\"number\"\n                        placeholder=\"Or enter custom...\"\n                        min=\"1\"\n                        max=\"360\"\n                        className={`${inputClasses} text-sm`}\n                        value={customPayments}\n                        onChange={(e) => setCustomPayments(e.target.value)}\n                      />\n                    </div>\n                  </div>\n\n                  <div>\n                    <label htmlFor=\"firstPaymentDate\" className={labelClasses}>\n                      First Payment Date\n                    </label>\n                    <input\n                      type=\"date\"\n                      id=\"firstPaymentDate\"\n                      name=\"firstPaymentDate\"\n                      required\n                      className={inputClasses}\n                      value={firstPaymentDate}\n                      onChange={(e) => setFirstPaymentDate(e.target.value)}\n                    />\n                  </div>\n\n                  <div>\n                    <label htmlFor=\"paymentFrequency\" className={labelClasses}>\n                      Payment Frequency\n                    </label>\n                    <select\n                      id=\"paymentFrequency\"\n                      name=\"paymentFrequency\"\n                      required\n                      className={inputClasses}\n                      value={paymentFrequency}\n                      onChange={(e) => setPaymentFrequency(e.target.value)}\n                    >\n                      {PAYMENT_FREQUENCIES.map((freq) => (\n                        <option key={freq.value} value={freq.value}>\n                          {freq.label}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n\n                {paymentPreview && (\n                  <div className=\"p-3 bg-accent/10 border border-accent/30 rounded-xl text-theme-primary text-sm\">\n                    <span className=\"font-medium text-accent\">Preview:</span> {paymentPreview}\n                  </div>\n                )}\n\n                <div className=\"border-t border-theme pt-4 space-y-3\">\n                  <div className=\"flex items-center gap-3\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"bnplHasInterest\"\n                      checked={bnplHasInterest}\n                      onChange={(e) => setBnplHasInterest(e.target.checked)}\n                      className=\"h-4 w-4 rounded border-theme bg-theme-secondary text-accent-600 focus:ring-accent-500\"\n                    />\n                    <label htmlFor=\"bnplHasInterest\" className=\"text-sm text-theme-secondary\">\n                      This BNPL loan has interest or finance charges\n                    </label>\n                  </div>\n\n                  {bnplHasInterest && (\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 pl-7\">\n                      <div>\n                        <label htmlFor=\"bnplInterestRate\" className={labelClasses}>\n                          Stated APR (%) <span className=\"text-theme-muted font-normal\">- if shown by provider</span>\n                        </label>\n                        <input\n                          type=\"number\"\n                          id=\"bnplInterestRate\"\n                          min=\"0\"\n                          max=\"100\"\n                          step=\"0.01\"\n                          placeholder=\"0.00\"\n                          className={inputClasses}\n                          value={interestRate}\n                          onChange={(e) => setInterestRate(e.target.value)}\n                        />\n                      </div>\n                      <div>\n                        <label htmlFor=\"totalRepayable\" className={labelClasses}>\n                          Total to Repay ($) <span className=\"text-theme-muted font-normal\">- if different from principal</span>\n                        </label>\n                        <input\n                          type=\"number\"\n                          id=\"totalRepayable\"\n                          min=\"0\"\n                          step=\"0.01\"\n                          placeholder={currentBalance || \"0.00\"}\n                          className={inputClasses}\n                          value={totalRepayable}\n                          onChange={(e) => setTotalRepayable(e.target.value)}\n                        />\n                        <p className=\"text-xs text-theme-muted mt-1\">\n                          Enter the total amount you&apos;ll pay including any built-in interest\n                        </p>\n                      </div>\n                    </div>\n                  )}\n\n                  {computedEffectiveAPR !== null && computedEffectiveAPR > 0 && (\n                    <div className=\"p-3 bg-warning-50 dark:bg-warning-600/10 border border-warning-200 dark:border-warning-600/30 rounded-xl text-sm\">\n                      <span className=\"font-medium text-warning-700 dark:text-warning-400\">Effective APR:</span>{\" \"}\n                      <span className=\"text-theme-primary\">{computedEffectiveAPR.toFixed(2)}%</span>\n                      <span className=\"text-theme-muted ml-2\">\n                        (computed from total repayable vs principal)\n                      </span>\n                    </div>\n                  )}\n\n                  {!bnplHasInterest && (\n                    <p className=\"text-xs text-theme-muted pl-7\">\n                      Leave unchecked for 0% promo BNPL (Afterpay, Klarna Pay in 4, etc.)\n                    </p>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {!isBNPL && (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label htmlFor=\"interestRate\" className={labelClasses}>\n                    Interest Rate (% APR)\n                  </label>\n                  <input\n                    type=\"number\"\n                    id=\"interestRate\"\n                    name=\"interestRate\"\n                    required\n                    min=\"0\"\n                    max=\"100\"\n                    step=\"0.01\"\n                    inputMode=\"decimal\"\n                    placeholder=\"19.99\"\n                    className={inputClasses}\n                  />\n                </div>\n\n                <div>\n                  <label htmlFor=\"minimumPayment\" className={labelClasses}>\n                    Minimum Payment ($)\n                  </label>\n                  <input\n                    type=\"number\"\n                    id=\"minimumPayment\"\n                    name=\"minimumPayment\"\n                    required\n                    min=\"0\"\n                    step=\"0.01\"\n                    inputMode=\"decimal\"\n                    placeholder=\"150.00\"\n                    className={inputClasses}\n                  />\n                </div>\n              </div>\n            )}\n\n            {!isBNPL && (\n              <div>\n                <label htmlFor=\"dueDay\" className={labelClasses}>\n                  Due Day of Month (1-31)\n                </label>\n                <input\n                  type=\"number\"\n                  id=\"dueDay\"\n                  name=\"dueDay\"\n                  required\n                  min=\"1\"\n                  max=\"31\"\n                  placeholder=\"15\"\n                  className={inputClasses}\n                />\n              </div>\n            )}\n\n            {bankAccounts.length > 0 && (\n              <div>\n                <label className={labelClasses}>Payment Bank Account</label>\n                <BankSelector\n                  value={selectedBankAccountId}\n                  onChange={setSelectedBankAccountId}\n                  banks={bankAccounts}\n                />\n              </div>\n            )}\n\n            <div>\n              <label htmlFor=\"notes\" className={labelClasses}>\n                Notes (optional)\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                placeholder=\"Any additional notes about this debt...\"\n                className={inputClasses}\n              />\n            </div>\n\n            <div className=\"flex gap-4 pt-4\">\n              <Button type=\"submit\" disabled={loading}>\n                {loading ? \"Creating...\" : \"Add Debt\"}\n              </Button>\n              <a href=\"/dashboard/debts\">\n                <Button type=\"button\" variant=\"secondary\">\n                  Cancel\n                </Button>\n              </a>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":["formatPaymentPreview","numberOfPayments","paymentAmount","firstPaymentDate","formatter","calculateEffectiveAPR","params","principal","totalRepayable","frequency","financeCharge","termInMonths","termInYears","effectiveAPR","DEBT_TYPES","PAYMENT_COUNTS","PAYMENT_FREQUENCIES","NewDebtForm","loading","setLoading","useState","error","setError","debtType","setDebtType","currentBalance","setCurrentBalance","setNumberOfPayments","customPayments","setCustomPayments","setFirstPaymentDate","paymentFrequency","setPaymentFrequency","bankAccounts","setBankAccounts","selectedBankAccountId","setSelectedBankAccountId","setTotalRepayable","interestRate","setInterestRate","bnplHasInterest","setBnplHasInterest","isBNPL","useEffect","res","data","defaultAccount","a","effectivePaymentCount","paymentPreview","useMemo","balance","total","computedEffectiveAPR","handleSubmit","e","formData","statedInterestRate","dueDay","result","inputClasses","labelClasses","jsxs","jsx","Button","ArrowLeft","Card","CardHeader","CardTitle","CardContent","type","count","freq","BankSelector"],"mappings":"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"}