import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as y}from"./index.Cd_vQiNd.js";import{L as O}from"./link.D3EDiB7B.js";import{C as k,c as P,a as S,b as $}from"./card.CxXQM9B9.js";import{B as A,L as T}from"./button.B0dCfUPv.js";import{S as R}from"./search-input.BPHSkXTY.js";import{E as B}from"./ellipsis-vertical.BSXrCKoh.js";import{P as M,T as z}from"./trash-2.B9ETjWXL.js";import{c as C}from"./createLucideIcon.DV6VgPWa.js";import{C as _}from"./chevron-down.DUqbYN4x.js";import{C as F}from"./chevron-right.BPMsxEET.js";import{C as E}from"./check.D23q9GVG.js";import{R as D}from"./receipt.xMvG92eM.js";import{P as U}from"./plus.t7qQNRkr.js";import{S as I}from"./shopping-bag.DyV4UZ3S.js";import{F as Y}from"./file-text.C5K_yrNJ.js";import{C as H}from"./credit-card.BTOJU1Ei.js";import{C as q}from"./calendar.5JjKPgNr.js";import"./x.DGcJ3xm4.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],W=C("landmark",J);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],K=C("power",G);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],V=C("shield-check",Q);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],X=C("tv",Z);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],te=C("zap",ee);function v({children:t,variant:d="default",size:n="md",dot:x=!1,pulse:m=!1,className:u=""}){const p=`
    inline-flex items-center gap-1.5
    font-medium rounded-full
    whitespace-nowrap
    transition-colors duration-200
  `,N={default:"bg-theme-tertiary text-theme-secondary border border-theme",success:"bg-success-50 text-success-700 border border-success-200 dark:bg-success-600/15 dark:text-success-400 dark:border-success-600/30",warning:"bg-warning-50 text-warning-700 border border-warning-200 dark:bg-warning-600/15 dark:text-warning-400 dark:border-warning-600/30",danger:"bg-danger-50 text-danger-700 border border-danger-200 dark:bg-danger-600/15 dark:text-danger-400 dark:border-danger-600/30",info:"bg-info-50 text-info-700 border border-info-200 dark:bg-info-600/15 dark:text-info-400 dark:border-info-600/30",accent:"bg-accent-50 text-accent-700 border border-accent-200 dark:bg-accent-600/15 dark:text-accent-400 dark:border-accent-600/30"},i={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm"},o={default:"bg-theme-muted",success:"bg-success-500",warning:"bg-warning-500",danger:"bg-danger-500",info:"bg-info-500",accent:"bg-accent-500"};return e.jsxs("span",{className:`${p} ${N[d]} ${i[n]} ${u}`,children:[x&&e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${o[d]} ${m?"animate-pulse-subtle":""}`}),t]})}function se({bill:t}){const[d,n]=y.useState(!1),[x,m]=y.useState(!1),u=async()=>{await fetch(`/api/bills/${t.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!t.isActive})}),window.location.reload(),n(!1)},p=async()=>{confirm(`Are you sure you want to delete "${t.name}"?`)&&(m(!0),await fetch(`/api/bills/${t.id}`,{method:"DELETE"}),window.location.reload(),n(!1),m(!1))};return e.jsxs("div",{className:"relative",children:[e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>n(!d),className:"h-8 w-8 p-0",children:e.jsx(B,{className:"h-4 w-4"})}),d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 z-20 w-48 rounded-lg bg-theme-secondary border border-theme shadow-lg py-1",children:[e.jsxs("a",{href:`/dashboard/bills/${t.id}/edit`,onClick:()=>n(!1),className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-theme-secondary hover:bg-theme-tertiary hover:text-theme-primary",children:[e.jsx(M,{className:"h-4 w-4"}),"Edit"]}),e.jsxs("button",{onClick:u,className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-theme-secondary hover:bg-theme-tertiary hover:text-theme-primary",children:[e.jsx(K,{className:"h-4 w-4"}),t.isActive?"Deactivate":"Activate"]}),e.jsxs("button",{onClick:p,disabled:x,className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-red-400 hover:bg-theme-tertiary hover:text-red-300",children:[e.jsx(z,{className:"h-4 w-4"}),x?"Deleting...":"Delete"]})]})]})]})}function ae({group:t}){const[d,n]=y.useState(!1),[x,m]=y.useState(new Set),u=async i=>{m(o=>new Set(o).add(i));try{(await fetch(`/api/bill-payments/${i}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({togglePaid:!0})})).ok&&window.location.reload()}catch(o){console.error("Failed to toggle payment:",o)}finally{m(o=>{const r=new Set(o);return r.delete(i),r})}},p=t.paidCount/t.totalCount*100,N=t.paidCount===t.totalCount;return e.jsxs("div",{className:"rounded-lg bg-theme-secondary overflow-hidden",children:[e.jsxs("button",{onClick:()=>n(!d),className:"w-full flex items-center justify-between py-3 px-4 hover:bg-theme-tertiary transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[d?e.jsx(_,{className:"h-4 w-4 text-theme-muted"}):e.jsx(F,{className:"h-4 w-4 text-theme-muted"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-theme-primary",children:t.debtName}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-theme-secondary",children:[e.jsxs("span",{children:[t.paidCount," of ",t.totalCount," payments"]}),N?e.jsx(v,{variant:"success",children:"Paid Off"}):t.nextPayment&&e.jsxs("span",{className:"text-theme-muted",children:["• Next: $",t.nextPayment.amount.toFixed(2)," on"," ",new Date(t.nextPayment.dueDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-semibold text-theme-primary",children:["$",(t.totalAmount-t.bills.filter(i=>i.payments[0]?.status==="PAID").reduce((i,o)=>i+Number(o.amount),0)).toFixed(2)]}),e.jsx("p",{className:"text-xs text-theme-muted",children:"remaining"})]}),e.jsx("div",{className:"w-24 h-2 bg-theme-tertiary rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-500 transition-all duration-300",style:{width:`${p}%`}})})]})]}),d&&e.jsx("div",{className:"border-t border-theme px-4 py-2 space-y-2",children:t.bills.map((i,o)=>{const r=i.payments[0],l=r?.status==="PAID",g=r&&x.has(r.id),b=r?.dueDate?new Date(r.dueDate):null;return e.jsxs("div",{className:`flex items-center justify-between py-2 px-3 rounded ${l?"opacity-60":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("button",{onClick:()=>u(r.id),disabled:g,className:`flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all ${l?"bg-accent-500 border-accent-500 text-white":"border-theme-muted hover:border-accent-500 text-transparent hover:text-accent-500"} ${g?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,title:l?"Mark as unpaid":"Mark as paid",children:g?e.jsx(T,{className:"h-3 w-3 animate-spin text-theme-muted"}):e.jsx(E,{className:"h-3 w-3"})}),e.jsxs("span",{className:"text-sm text-theme-secondary",children:["Payment ",o+1]}),b&&e.jsx("span",{className:"text-xs text-theme-muted",children:b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-sm font-medium ${l?"text-theme-muted line-through":"text-theme-primary"}`,children:["$",Number(i.amount).toFixed(2)]}),l&&e.jsx(v,{variant:"success",className:"text-xs",children:"Paid"})]})]},i.id)})})]})}const ne={SUBSCRIPTION:"Subscriptions",UTILITY:"Utilities",LOAN:"Loans",BNPL:"Buy Now Pay Later",INSURANCE:"Insurance",CREDIT_CARD:"Credit Cards",OTHER:"Other"},re={SUBSCRIPTION:X,UTILITY:te,LOAN:W,BNPL:I,INSURANCE:V,CREDIT_CARD:H,OTHER:Y};function ie(t,d){return d?{ONCE:"One-time",WEEKLY:"Weekly",BIWEEKLY:"Bi-weekly",MONTHLY:"Monthly",YEARLY:"Yearly"}[t]||t:"One-time"}function ce(t){return!t.isRecurring&&t.payments.length>0?new Date(t.payments[0].dueDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):`Day ${t.dueDay}`}function Le({regularBills:t,bnplGroups:d}){const[n,x]=y.useState(""),[m,u]=y.useState(new Set),[p,N]=y.useState(new Set),i=async(a,h)=>{u(c=>new Set(c).add(a));try{(await fetch(`/api/bill-payments/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({togglePaid:!0})})).ok&&(h?window.location.reload():(N(s=>new Set(s).add(a)),setTimeout(()=>{window.location.reload()},600)))}catch(c){console.error("Failed to toggle payment:",c)}finally{u(c=>{const s=new Set(c);return s.delete(a),s})}},o=Object.keys(t),r={};for(const a of o){const h=t[a].filter(c=>{if(!n)return!0;const s=n.toLowerCase();return c.name.toLowerCase().includes(s)||c.category.toLowerCase().includes(s)||(c.notes?.toLowerCase().includes(s)??!1)||(c.debt?.name.toLowerCase().includes(s)??!1)});h.length>0&&(r[a]=h)}const l=d.filter(a=>{if(!n)return!0;const h=n.toLowerCase();return a.debtName.toLowerCase().includes(h)||a.bills.some(c=>c.name.toLowerCase().includes(h))}),g=Object.keys(r),b=g.length>0||l.length>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{value:n,onChange:x,placeholder:"Search bills...",className:"max-w-md"}),!b&&n?e.jsx(k,{children:e.jsxs(P,{className:"py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-theme-tertiary flex items-center justify-center mx-auto mb-4",children:e.jsx(D,{className:"h-8 w-8 text-theme-muted"})}),e.jsx("h3",{className:"text-lg font-semibold text-theme-primary mb-2",children:"No bills found"}),e.jsxs("p",{className:"text-theme-secondary",children:['No bills match "',n,'"']})]})}):b?e.jsxs("div",{className:"space-y-6",children:[l.length>0&&e.jsxs(k,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-theme-tertiary",children:e.jsx(I,{className:"h-5 w-5 text-theme-secondary"})}),e.jsxs("div",{children:[e.jsx($,{children:"Buy Now Pay Later"}),e.jsxs("p",{className:"text-sm text-theme-secondary mt-0.5",children:[l.length," active plan",l.length!==1?"s":""]})]})]})}),e.jsx(P,{noPadding:!0,children:e.jsx("div",{className:"divide-y divide-theme",children:l.map(a=>e.jsx(ae,{group:a},a.debtId))})})]}),g.map((a,h)=>{const c=re[a];return e.jsxs(k,{className:`animate-fade-in-up stagger-${h+1}`,children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-theme-tertiary",children:e.jsx(c,{className:"h-5 w-5 text-theme-secondary"})}),e.jsxs("div",{children:[e.jsx($,{children:ne[a]}),e.jsxs("p",{className:"text-sm text-theme-secondary mt-0.5",children:[r[a].length," bill",r[a].length!==1?"s":""]})]})]})}),e.jsx(P,{noPadding:!0,children:e.jsx("div",{className:"divide-y divide-theme",children:r[a].map(s=>{const f=s.payments[0],j=f?.status==="PAID",L=f&&m.has(f.id),w=f&&p.has(f.id);return e.jsxs("div",{className:`flex items-center justify-between py-4 px-6 hover:bg-theme-secondary/50 transition-colors ${s.isActive?"":"opacity-50"} ${w?"animate-fade-out-right bg-accent-500/10":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f&&e.jsx("button",{onClick:()=>i(f.id,j),disabled:L||w,className:`flex-shrink-0 w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all ${j||w?"bg-accent-500 border-accent-500 text-white":"border-theme-muted hover:border-accent-500 text-transparent hover:text-accent-500"} ${L||w?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,title:j?"Mark as unpaid":"Mark as paid",children:L?e.jsx(T,{className:"h-4 w-4 animate-spin text-theme-muted"}):e.jsx(E,{className:`h-4 w-4 ${w?"text-white":""}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("p",{className:`font-medium ${j?"text-theme-muted line-through":"text-theme-primary"}`,children:s.name}),!s.isActive&&e.jsx(v,{variant:"default",size:"sm",children:"Inactive"}),s.debt&&e.jsx(v,{variant:"warning",size:"sm",children:"Linked to debt"}),j&&e.jsx(v,{variant:"success",size:"sm",children:"Paid"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-theme-secondary",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"}),ce(s)]}),e.jsx("span",{className:"text-theme-muted",children:"•"}),e.jsx("span",{children:ie(s.frequency,s.isRecurring)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:`text-lg font-semibold ${j?"text-theme-muted":"text-theme-primary"}`,children:["$",Number(s.amount).toFixed(2)]}),e.jsx(se,{bill:{id:s.id,name:s.name,isActive:s.isActive}})]})]},s.id)})})})]},a)})]}):e.jsx(k,{children:e.jsxs(P,{className:"py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-theme-tertiary flex items-center justify-center mx-auto mb-4",children:e.jsx(D,{className:"h-8 w-8 text-theme-muted"})}),e.jsx("h3",{className:"text-lg font-semibold text-theme-primary mb-2",children:"No bills yet"}),e.jsx("p",{className:"text-theme-secondary mb-6",children:"Add your first bill to start tracking your expenses"}),e.jsx(O,{href:"/dashboard/bills/new",children:e.jsx(A,{leftIcon:e.jsx(U,{className:"h-4 w-4"}),children:"Add Your First Bill"})})]})})]})}export{Le as BillsList};
//# sourceMappingURL=bills-list.8LmmXcJQ.js.map
