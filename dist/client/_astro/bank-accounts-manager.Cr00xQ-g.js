import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.Cd_vQiNd.js";import{B as E}from"./bank-account-card.BHVOEqZu.js";import{B as u}from"./button.B0dCfUPv.js";import{a as B}from"./bank-badge.D8M1MxtW.js";import{B as P}from"./building-2.CScN-oDP.js";import{P as N}from"./plus.t7qQNRkr.js";import{X as T}from"./x.DGcJ3xm4.js";import"./createLucideIcon.DV6VgPWa.js";import"./ellipsis-vertical.BSXrCKoh.js";import"./trash-2.B9ETjWXL.js";function X(){const[o,m]=r.useState([]),[v,w]=r.useState(!0),[h,d]=r.useState(!1),[l,b]=r.useState(null),[s,c]=r.useState({name:"",bank:"CHASE",lastFour:"",isDefault:!1}),[g,p]=r.useState(!1),[y,i]=r.useState("");r.useEffect(()=>{k()},[]);async function k(){try{const t=await fetch("/api/bank-accounts");if(t.ok){const a=await t.json();m(a)}}catch{}finally{w(!1)}}function f(){c({name:"",bank:"CHASE",lastFour:"",isDefault:!1}),b(null),d(!1),i("")}function D(t){const a=o.find(n=>n.id===t);a&&(c({name:a.name,bank:a.bank,lastFour:a.lastFour||"",isDefault:a.isDefault}),b(t),d(!0))}async function F(t){if(confirm("Are you sure you want to delete this bank account?"))try{(await fetch(`/api/bank-accounts/${t}`,{method:"DELETE"})).ok&&m(o.filter(n=>n.id!==t))}catch{i("Failed to delete account")}}async function A(t){try{(await fetch(`/api/bank-accounts/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefault:!0})})).ok&&m(o.map(n=>({...n,isDefault:n.id===t})))}catch{i("Failed to set default account")}}async function S(t){t.preventDefault(),i(""),p(!0);try{const a=l?`/api/bank-accounts/${l}`:"/api/bank-accounts",j=await fetch(a,{method:l?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s.name,bank:s.bank,lastFour:s.lastFour||null,isDefault:s.isDefault})});if(!j.ok){const C=await j.json();throw new Error(C.error||"Failed to save account")}await k(),f()}catch(a){i(a instanceof Error?a.message:"Something went wrong")}finally{p(!1)}}const x="w-full px-4 py-2.5 bg-theme-secondary border border-theme rounded-xl text-theme-primary placeholder-theme-muted focus:outline-none focus:ring-2 focus:ring-accent-500/20 focus:border-accent-500";return v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-500"})}):e.jsxs("div",{className:"space-y-6",children:[o.length===0&&!h?e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800/50 rounded-xl border-2 border-dashed border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mx-auto mb-4",children:e.jsx(P,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"No Bank Accounts Yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4 max-w-sm mx-auto",children:"Add your bank accounts to track which account each bill comes from and see transfer amounts per account."}),e.jsx(u,{onClick:()=>d(!0),leftIcon:e.jsx(N,{className:"h-4 w-4"}),children:"Add Bank Account"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(t=>e.jsx(E,{id:t.id,name:t.name,bank:t.bank,lastFour:t.lastFour,isDefault:t.isDefault,onEdit:D,onDelete:F,onSetDefault:A},t.id))}),!h&&e.jsx(u,{variant:"secondary",onClick:()=>d(!0),leftIcon:e.jsx(N,{className:"h-4 w-4"}),children:"Add Bank Account"})]}),h&&e.jsxs("div",{className:"bg-white dark:bg-[#1c2128] rounded-xl border border-gray-200 dark:border-[#30363d] p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:l?"Edit Bank Account":"Add Bank Account"}),e.jsx("button",{onClick:f,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsx(T,{className:"h-5 w-5 text-gray-500"})})]}),e.jsxs("form",{onSubmit:S,className:"space-y-5",children:[y&&e.jsx("div",{className:"p-3 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 text-sm",children:y}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-theme-secondary",children:"Account Name *"}),e.jsx("input",{type:"text",id:"name",required:!0,value:s.name,onChange:t=>c({...s,name:t.target.value}),placeholder:"e.g., Primary Checking",className:x})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"bank",className:"block text-sm font-medium text-theme-secondary",children:"Bank *"}),e.jsx("select",{id:"bank",required:!0,value:s.bank,onChange:t=>c({...s,bank:t.target.value}),className:x,children:B.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"lastFour",className:"block text-sm font-medium text-theme-secondary",children:"Last 4 Digits (Optional)"}),e.jsx("input",{type:"text",id:"lastFour",maxLength:4,pattern:"[0-9]*",value:s.lastFour,onChange:t=>c({...s,lastFour:t.target.value.replace(/\D/g,"")}),placeholder:"1234",className:x})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-8",children:[e.jsx("input",{type:"checkbox",id:"isDefault",checked:s.isDefault,onChange:t=>c({...s,isDefault:t.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-accent-600 focus:ring-accent-500"}),e.jsx("label",{htmlFor:"isDefault",className:"text-sm font-medium text-theme-secondary",children:"Set as default account"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(u,{type:"submit",disabled:g,children:g?"Saving...":l?"Update Account":"Add Account"}),e.jsx(u,{type:"button",variant:"secondary",onClick:f,children:"Cancel"})]})]})]})]})}export{X as BankAccountsManager};
//# sourceMappingURL=bank-accounts-manager.Cr00xQ-g.js.map
